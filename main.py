import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go

chartsvg = """<svg width="48" height="48" viewBox="0 0 94 120" fill="#FF4E4C" xmlns="http://www.w3.org/2000/svg" stroke-width="1px" stroke-linecap="round" stroke-linejoin="round"><path d="M90.3318 73.3397L90.1218 73.2397C89.5018 72.9797 88.7518 73.1098 87.8718 73.6198L25.7117 109.51C24.7417 110.07 23.9217 110.92 23.2517 112.07C22.5917 113.21 22.2617 114.34 22.2617 115.46C22.2617 116.58 22.5917 117.33 23.2517 117.71C23.9217 118.09 24.7417 118 25.7117 117.43L87.8718 81.5397C88.8518 80.9797 89.6718 80.1297 90.3318 78.9797C91.0018 77.8397 91.3318 76.7097 91.3318 75.5897C91.3318 74.4697 91.0018 73.7097 90.3318 73.3397Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M87.8718 16.1598V63.7099C87.8718 65.3599 87.3718 67.0598 86.3618 68.7898C85.9518 69.4998 85.5117 70.1299 85.0317 70.6899C84.3217 71.4999 83.5419 72.1598 82.6919 72.6498C81.2519 73.4798 80.0317 73.6098 79.0217 73.0298C78.0217 72.4598 77.5117 71.3399 77.5117 69.6899V22.1399C77.5117 20.4899 78.0217 18.7999 79.0217 17.0599C80.0317 15.3199 81.2519 14.0399 82.6919 13.2099C83.9819 12.4599 85.1118 12.2798 86.0518 12.6698L86.3618 12.8199C87.3718 13.3999 87.8718 14.5098 87.8718 16.1598Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M90.1218 73.2399C89.5018 72.9799 88.7518 73.1099 87.8718 73.6199L25.7117 109.51C24.7417 110.07 23.9217 110.92 23.2517 112.07C22.5917 113.21 22.2617 114.34 22.2617 115.46C22.2617 116.58 22.5917 117.33 23.2517 117.71L3.46167 107.81L3.25171 107.71C2.59171 107.33 2.26172 106.58 2.26172 105.46C2.26172 104.34 2.59171 103.21 3.25171 102.07C3.92171 100.92 4.74167 100.07 5.71167 99.5099L12.5117 95.5798L19.8618 99.2599L27.2317 102.94C28.2317 103.51 29.4618 103.38 30.8918 102.55C32.3318 101.72 33.5618 100.44 34.5618 98.6998C35.5718 96.9598 36.0718 95.2699 36.0718 93.6199V88.7599L37.1318 89.2898L44.4917 92.9698C45.5017 93.5398 46.7219 93.4098 48.1619 92.5798C49.6019 91.7498 50.8218 90.4699 51.8318 88.7299C52.8418 86.9899 53.3418 85.2998 53.3418 83.6498V78.7898L54.4019 79.3198L61.7617 82.9999C62.7717 83.5699 63.9919 83.4499 65.4319 82.6199C66.8719 81.7799 68.0918 80.4999 69.1018 78.7599C70.1018 77.0299 70.6118 75.3298 70.6118 73.6798V68.8298L79.0217 73.0298C80.0317 73.6098 81.2519 73.4798 82.6919 72.6498C83.5419 72.1598 84.3217 71.4998 85.0317 70.6898L90.1218 73.2399Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M70.6121 49.8997V73.6797C70.6121 75.3297 70.1021 77.0298 69.1021 78.7598C68.0921 80.4998 66.8721 81.7798 65.4321 82.6198C63.9921 83.4498 62.772 83.5698 61.762 82.9998C60.752 82.4298 60.252 81.3097 60.252 79.6597V55.8898C60.252 54.2398 60.752 52.5397 61.762 50.7997C62.772 49.0697 63.9921 47.7798 65.4321 46.9498C66.3321 46.4298 67.1421 46.1898 67.8721 46.2198C68.1821 46.2298 68.482 46.2897 68.762 46.3997L69.1021 46.5698C70.1021 47.1398 70.6121 48.2497 70.6121 49.8997Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M86.0518 12.6698C85.1118 12.2798 83.9819 12.4598 82.6919 13.2098C81.2519 14.0398 80.0317 15.3198 79.0217 17.0598C78.0217 18.7998 77.5117 20.4899 77.5117 22.1399V69.6898C77.5117 71.3398 78.0217 72.4597 79.0217 73.0297L70.6118 68.8298V49.8997C70.6118 48.2497 70.1018 47.1398 69.1018 46.5698L68.7617 46.3997L67.8718 45.9598L57.5117 40.7797V12.1398C57.5117 10.4898 58.0217 8.79977 59.0217 7.05977C60.0317 5.31977 61.2519 4.0398 62.6919 3.2098C64.1319 2.3798 65.3618 2.24978 66.3618 2.81978L86.0518 12.6698Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M53.3425 47.9899V83.6498C53.3425 85.2998 52.8425 86.9899 51.8325 88.7299C50.8225 90.4699 49.6026 91.7498 48.1626 92.5798C46.7226 93.4098 45.5024 93.5398 44.4924 92.9698C43.4824 92.3898 42.9824 91.2799 42.9824 89.6299V53.9698C42.9824 52.3198 43.4824 50.6199 44.4924 48.8799C45.5024 47.1499 46.7226 45.8598 48.1626 45.0298C49.0626 44.5098 49.8825 44.2598 50.6125 44.2998C50.9325 44.3098 51.2325 44.3699 51.5125 44.4899L51.8325 44.6498C52.8425 45.2198 53.3425 46.3299 53.3425 47.9899Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M36.071 77.7698V93.6198C36.071 95.2698 35.571 96.9597 34.561 98.6997C33.561 100.44 32.3311 101.72 30.8911 102.55C29.4611 103.38 28.231 103.51 27.231 102.94C26.221 102.36 25.7109 101.25 25.7109 99.5997V83.7498C25.7109 83.6898 25.7109 83.6397 25.7209 83.5797C25.7109 83.4897 25.7209 83.3997 25.7209 83.3097C25.8009 81.7997 26.311 80.2497 27.231 78.6697C28.231 76.9297 29.4611 75.6497 30.8911 74.8097C31.7911 74.2897 32.6011 74.0497 33.3311 74.0897C33.6511 74.0997 33.961 74.1597 34.251 74.2797L34.561 74.4297C35.571 74.9997 36.071 76.1198 36.071 77.7698Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M68.7617 46.3999C68.4817 46.2899 68.1818 46.2299 67.8718 46.2199C67.1418 46.1899 66.3319 46.4299 65.4319 46.9499C63.9919 47.7799 62.7717 49.0699 61.7617 50.7999C60.7517 52.5399 60.2517 54.24 60.2517 55.89V79.6599C60.2517 81.3099 60.7517 82.43 61.7617 83L54.4019 79.3199L53.3418 78.7899V47.9899C53.3418 46.3299 52.8418 45.2199 51.8318 44.6499L51.5117 44.4899L50.6118 44.0399L42.3418 39.8999C43.2218 38.6199 44.2519 37.6299 45.4319 36.9499C46.8719 36.1199 48.0918 35.9899 49.1018 36.5699L57.5117 40.7799L67.8718 45.9599L68.7617 46.3999Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M51.5125 44.4898C51.2325 44.3698 50.9325 44.3098 50.6125 44.2998C49.8825 44.2598 49.0626 44.5097 48.1626 45.0297C46.7226 45.8597 45.5024 47.1498 44.4924 48.8798C43.4824 50.6198 42.9824 52.3198 42.9824 53.9698V89.6298C42.9824 91.2798 43.4824 92.3898 44.4924 92.9698L37.1326 89.2897L36.0725 88.7598V77.7699C36.0725 76.1199 35.5725 74.9998 34.5625 74.4298L34.2524 74.2797L33.3325 73.8198L22.9824 68.6398V43.9698C22.9824 42.3198 23.4824 40.6198 24.4924 38.8798C25.5024 37.1498 26.7226 35.8597 28.1626 35.0297C29.6026 34.1997 30.8225 34.0697 31.8325 34.6497L42.3425 39.8997L50.6125 44.0398L51.5125 44.4898Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M34.251 74.2799C33.961 74.1599 33.6511 74.0999 33.3311 74.0899C32.6011 74.0499 31.7911 74.2899 30.8911 74.8099C29.4611 75.6499 28.231 76.9299 27.231 78.6699C26.311 80.2499 25.8009 81.7999 25.7209 83.3099C25.7209 83.3999 25.7109 83.4899 25.7209 83.5799C25.7109 83.6399 25.7109 83.6899 25.7109 83.7499V99.5999C25.7109 101.25 26.221 102.36 27.231 102.94L19.8611 99.26L12.511 95.5799L7.54102 93.0899L7.23096 92.9399C6.22096 92.3599 5.71094 91.2499 5.71094 89.5999V73.7499C5.71094 72.0999 6.22096 70.3999 7.23096 68.6699C8.23096 66.9299 9.46111 65.6499 10.8911 64.8099C12.3311 63.9799 13.561 63.8599 14.561 64.4299L22.981 68.64L33.3311 73.8199L34.251 74.2799Z" stroke="#0B0B0F" stroke-linejoin="round"/></svg>"""
statsvg = """<svg width="48" height="48" viewBox="0 0 94 110" fill="#FF4E4C" xmlns="http://www.w3.org/2000/svg" stroke-width="1px" stroke-linecap="round" stroke-linejoin="round"><path d="M23.1113 106.956C23.3013 107.126 23.5313 107.246 23.8113 107.306L23.1113 106.956Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M90.6309 81.1459L82.8208 76.6959C83.5808 74.9459 84.151 73.2059 84.531 71.4559C84.911 69.7159 85.1008 68.0259 85.1008 66.4159C85.1008 61.7459 83.6708 58.5959 80.8208 56.9659L80.2009 56.6559C77.4709 55.4059 74.2309 55.8759 70.4509 58.0559C68.1009 59.4059 65.961 61.1859 64.021 63.3959C62.591 65.0159 61.2708 66.8659 60.0708 68.9559C58.6408 71.4159 57.5708 73.8459 56.8608 76.2559C56.1508 78.6359 55.8008 81.0059 55.8008 83.3259C55.8008 87.9959 57.2208 91.1459 60.0708 92.7659C62.9208 94.3959 66.3809 94.0259 70.4509 91.6759C71.8609 90.8659 73.2308 89.8559 74.5608 88.6559C75.7908 87.5359 76.9109 86.2959 77.9309 84.9359C78.0209 84.8259 78.1009 84.7159 78.1809 84.6059L86.0708 89.0059C86.7208 89.3759 87.5009 89.3059 88.3909 88.7859C89.2909 88.2759 90.0609 87.4559 90.7109 86.3259C91.3609 85.2059 91.6809 84.1559 91.6509 83.1759C91.6209 82.1959 91.2809 81.5159 90.6309 81.1459ZM76.231 78.1659C75.251 79.8459 74.1309 81.2659 72.8809 82.4159C72.1209 83.1159 71.3109 83.7059 70.4509 84.2059C68.1709 85.5259 66.2409 85.7359 64.6709 84.8359C63.0909 83.9359 62.3108 82.1859 62.3108 79.5659C62.3108 78.7359 62.3908 77.8959 62.5608 77.0459C62.8908 75.2459 63.5909 73.4159 64.6709 71.5759C65.2509 70.5659 65.8908 69.6559 66.5708 68.8359C67.7208 67.4559 69.0209 66.3559 70.4509 65.5259C72.7309 64.2159 74.651 64.0059 76.231 64.9059C77.801 65.7959 78.5908 67.5559 78.5908 70.1659C78.5908 72.7759 77.801 75.4459 76.231 78.1659Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M78.5916 70.1659C78.5916 72.7859 77.8017 75.4459 76.2317 78.1659C75.2517 79.8459 74.1316 81.2659 72.8816 82.4159C72.1216 83.1159 71.3117 83.7059 70.4517 84.2059C68.1717 85.5259 66.2416 85.7359 64.6716 84.8359C63.0916 83.9359 62.3115 82.1859 62.3115 79.5659C62.3115 78.7359 62.3915 77.8959 62.5615 77.0459C62.8915 75.2459 63.5916 73.4159 64.6716 71.5759C65.2516 70.5659 65.8915 69.6559 66.5715 68.8359C67.7215 67.4559 69.0217 66.3559 70.4517 65.5259C72.7317 64.2159 74.6517 64.0059 76.2317 64.9059C77.8017 65.7959 78.5916 67.5559 78.5916 70.1659Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M91.3615 17.5859L78.9115 47.1959C78.3115 48.5959 77.6016 49.6059 76.7516 50.2159C75.9116 50.8259 75.1415 51.0859 74.4315 50.9959C74.2615 50.9759 74.0916 50.9259 73.9516 50.8559L73.7316 50.7459C73.3916 50.5259 73.1416 50.1759 72.9716 49.6959C72.7016 48.9159 72.8616 47.8259 73.4616 46.4159L85.8314 16.7659C86.3214 15.6159 87.0216 14.6459 87.9516 13.8659C88.8716 13.0859 89.7116 12.8159 90.4716 13.0659C91.1716 13.2159 91.6116 13.7259 91.7716 14.5959C91.9316 15.4759 91.8015 16.4659 91.3615 17.5859Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M70.4707 3.06592L71.1907 3.4259C70.9907 3.2459 70.7507 3.12592 70.4707 3.06592Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M36.5109 67.566L32.8807 65.746L20.5009 59.556C19.7409 59.066 18.8309 59.166 17.7709 59.876C16.7109 60.576 15.8807 61.636 15.2907 63.036L3.00086 92.736C2.56086 93.856 2.41066 94.856 2.55066 95.746C2.68066 96.636 3.11067 97.156 3.81067 97.306L23.1107 106.956C22.8207 106.686 22.6307 106.286 22.5507 105.746C22.4107 104.856 22.5609 103.856 23.0009 102.736L33.0309 78.496L35.2906 73.036C35.4606 72.646 35.6407 72.276 35.8507 71.936C36.3707 71.066 37.0109 70.376 37.7709 69.876C38.6509 69.296 39.4307 69.106 40.1107 69.356L36.5109 67.566Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M90.4706 13.0659C89.7106 12.8159 88.8706 13.0859 87.9506 13.8659C87.0206 14.6459 86.3205 15.6159 85.8305 16.7659L73.4606 46.4159C72.8606 47.8259 72.7006 48.9159 72.9706 49.6959C73.1406 50.1759 73.3906 50.5259 73.7306 50.7459L53.9706 40.8759L53.8505 40.8159C53.4505 40.6059 53.1606 40.2359 52.9706 39.6959C52.7006 38.9159 52.8606 37.8259 53.4606 36.4159L65.8305 6.76588C66.3205 5.61588 67.0206 4.64586 67.9506 3.86586C68.8706 3.08586 69.7106 2.81587 70.4706 3.06587L90.4706 13.0659Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M62.6511 45.766C62.0711 45.526 61.3512 45.666 60.4812 46.166C60.2912 46.276 60.1012 46.396 59.9312 46.536C58.9912 47.236 58.2612 48.236 57.7612 49.516L55.6711 54.636L47.4211 74.8159L42.4111 71.006L40.5112 69.5559L40.1211 69.356L36.5212 67.5659L32.8911 65.7459L28.0312 63.3159L37.7612 39.516C38.3612 37.986 39.2712 36.866 40.4912 36.166C41.4012 35.636 42.1512 35.516 42.7412 35.796L42.821 35.836L62.6611 45.766H62.6511Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M45.3811 84.6758L43.541 83.7558H43.5312L37.9612 80.9658C37.9612 80.9658 37.8911 80.8958 37.8711 80.8558L38.4612 79.4258L44.1611 83.7558L45.3811 84.6758Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M37.9607 80.9658L37.8506 80.9058" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M67.1508 52.8159C66.9108 53.9259 66.4308 54.9259 65.7308 55.8359C65.5208 56.0959 65.3107 56.3359 65.1007 56.5559C64.5707 57.0959 64.0108 57.4959 63.4108 57.7759C62.5708 58.1759 61.8509 58.016 61.2509 57.296L60.6808 56.6959L58.4308 62.1959L55.5309 69.2659L50.6708 81.1559C50.5908 81.3459 50.5108 81.5259 50.4108 81.6959C49.8408 82.8359 49.0908 83.7359 48.1508 84.3859C47.0608 85.1359 46.1407 85.2259 45.3807 84.6759L44.1608 83.7559L38.4608 79.4259L37.8707 80.856L37.8507 80.9059L28.5309 103.556C28.0409 104.766 27.3207 105.756 26.3707 106.526C25.4207 107.296 24.5707 107.556 23.8107 107.306L23.1107 106.956C22.8207 106.686 22.6307 106.286 22.5507 105.746C22.4107 104.856 22.5609 103.856 23.0009 102.736L33.0309 78.4959L35.2907 73.0359C35.4607 72.6459 35.6407 72.2759 35.8507 71.9359C36.3707 71.0659 37.0109 70.3759 37.7709 69.8759C38.6509 69.2959 39.4307 69.106 40.1107 69.356L40.5009 69.5559L42.4008 71.0059L47.4108 74.8159L55.6608 54.6359L57.7509 49.5159C58.2509 48.2359 58.9808 47.2359 59.9208 46.5359C60.0908 46.3959 60.2808 46.276 60.4708 46.166C61.3408 45.666 62.0607 45.5259 62.6407 45.7659L62.8707 45.8759C63.0107 45.9659 63.1509 46.0859 63.2709 46.2259L66.2709 49.6959L66.6107 50.0859C67.2107 50.8059 67.3807 51.7159 67.1407 52.8159H67.1508Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M80.2009 56.6558C77.4709 55.4058 74.2309 55.8758 70.4509 58.0558C68.1009 59.4058 65.961 61.1858 64.021 63.3958C62.591 65.0158 61.2708 66.8658 60.0708 68.9558C58.6408 71.4158 57.5708 73.8458 56.8608 76.2558C56.1508 78.6358 55.8008 81.0058 55.8008 83.3258C55.8008 87.9958 57.2208 91.1458 60.0708 92.7658L40.9609 83.2058L40.0708 82.7658C39.2408 82.2958 38.5409 81.6958 37.9609 80.9658L43.531 83.7558H43.5408L45.3809 84.6758C46.1409 85.2258 47.0609 85.1358 48.1509 84.3858C49.0909 83.7358 49.8409 82.8358 50.4109 81.6958C50.5109 81.5258 50.5909 81.3458 50.6709 81.1558L55.531 69.2658L58.4309 62.1958L60.6809 56.6958L61.251 57.2958C61.851 58.0158 62.5709 58.1758 63.4109 57.7758C64.0109 57.4958 64.5708 57.0958 65.1008 56.5558C65.3108 56.3358 65.521 56.0958 65.731 55.8358C66.431 54.9258 66.9109 53.9258 67.1509 52.8158C67.3909 51.7158 67.2208 50.8058 66.6208 50.0858L66.281 49.6958L80.2009 56.6558Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M86.0706 89.0059L77.9307 84.9359C78.0207 84.8259 78.1007 84.716 78.1807 84.606L86.0706 89.0059Z" stroke="#0B0B0F" stroke-linejoin="round"/></svg>"""
peoplesvg = """<svg width="48" height="48" viewBox="0 0 89 115" fill="#FF4E4C" xmlns="http://www.w3.org/2000/svg" stroke-width="1px" stroke-linecap="round" stroke-linejoin="round"><path d="M62.8002 18.54C62.8002 21.11 62.0003 23.78 60.4003 26.54C60.1103 27.03 59.8203 27.5 59.5103 27.95C59.4003 28.11 59.2902 28.27 59.1802 28.42C57.8502 30.24 56.3403 31.64 54.6403 32.62C52.3903 33.92 50.4702 34.11 48.8702 33.2C47.2702 32.29 46.4702 30.54 46.4702 27.97C46.4702 26.16 46.8602 24.31 47.6602 22.41C47.9802 21.6 48.3902 20.79 48.8702 19.96C50.4702 17.21 52.3903 15.1801 54.6403 13.8801C56.6503 12.7201 58.4003 12.45 59.8903 13.06L60.4003 13.31C62.0003 14.22 62.8002 15.96 62.8002 18.54Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M86.9801 44.86C86.9801 46.18 86.6101 47.4899 85.8601 48.7799C85.1101 50.0799 84.1601 51.05 83.0001 51.72C81.8501 52.39 80.9001 52.51 80.1501 52.08L66.8801 44.5199V95.81C66.8801 97.14 66.4901 98.47 65.7101 99.82C64.9201 101.17 63.96 102.18 62.8 102.85C61.64 103.52 60.6701 103.63 59.8901 103.18C59.1101 102.74 58.7201 101.85 58.7201 100.52V77.1L50.55 81.82V105.24C50.55 106.56 50.1601 107.9 49.3801 109.25C48.6001 110.6 47.6301 111.61 46.4701 112.28C45.3101 112.94 44.35 113.06 43.56 112.61C42.78 112.16 42.3901 111.28 42.3901 109.95V52.69C38.1301 53.85 34.4701 53.7 31.3901 52.23L30.93 52C30.09 51.56 29.3 51.01 28.56 50.37C24.99 47.28 22.86 42.65 22.18 36.48C22.05 35.47 22.3901 34.36 23.2001 33.14C23.2901 33 23.3901 32.87 23.4801 32.74C24.2401 31.72 25.09 30.94 26.06 30.38C27.15 29.75 28.1 29.53 28.92 29.73C29.07 29.77 29.2201 29.82 29.3501 29.89H29.3801C29.5001 29.97 29.6101 30.05 29.7101 30.14C30.0501 30.47 30.2601 30.9699 30.3501 31.6499C31.1001 36.8399 33.21 40.31 36.67 42.05C39.52 43.49 42.9301 43.34 46.8801 41.6C47.7401 41.23 48.6201 40.78 49.5301 40.25L53.2101 38.13L59.7401 34.36C61.7801 33.18 63.6801 32.51 65.4501 32.35C65.6301 32.33 65.8101 32.32 65.9901 32.32C67.2801 32.26 68.4701 32.49 69.5701 32.98L70.2501 33.32L85.8601 42.23C86.6101 42.65 86.9801 43.53 86.9801 44.86Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M43.5601 112.61L23.5601 102.61C22.7801 102.16 22.3901 101.28 22.3901 99.95V47.73L30.9301 52L31.3901 52.23C34.4701 53.7 38.1301 53.8499 42.3901 52.6899V109.95C42.3901 111.28 42.7801 112.16 43.5601 112.61Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M69.5699 32.98C68.4699 32.49 67.28 32.2599 65.99 32.3199C65.81 32.3199 65.63 32.33 65.45 32.35C63.68 32.51 61.78 33.18 59.74 34.36L53.21 38.13L49.53 40.25C48.62 40.78 47.74 41.23 46.88 41.6C42.93 43.34 39.5199 43.4899 36.6699 42.0499C33.2099 40.3099 31.1 36.8399 30.35 31.6499C30.26 30.9699 30.05 30.47 29.71 30.14L35.77 26.6499L48.87 33.2C50.47 34.11 52.39 33.92 54.64 32.62C56.34 31.64 57.8499 30.2399 59.1799 28.4199C59.2899 28.2699 59.4 28.11 59.51 27.95L69.5699 32.98Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M59.8901 103.18L50.55 98.51V81.8199L58.7201 77.1V100.52C58.7201 101.85 59.1101 102.74 59.8901 103.18Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M30.93 52L22.3901 47.73L11.5201 42.2899L11.4401 42.25C10.4201 41.77 9.46005 41.14 8.56005 40.37C4.99005 37.28 2.86004 32.65 2.18004 26.48C2.05004 25.47 2.39006 24.36 3.20006 23.14C4.02006 21.93 4.97005 21.01 6.06005 20.38C7.15005 19.75 8.10003 19.53 8.92003 19.73C9.09003 19.77 9.24012 19.8299 9.38012 19.8999L29.3501 29.89C29.2201 29.82 29.07 29.77 28.92 29.73C28.1 29.53 27.15 29.75 26.06 30.38C25.09 30.94 24.2401 31.72 23.4801 32.74C23.3901 32.87 23.2901 33 23.2001 33.14C22.3901 34.36 22.05 35.47 22.18 36.48C22.86 42.65 24.99 47.28 28.56 50.37C29.3 51.01 30.09 51.56 30.93 52Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M80.1501 52.08L66.8801 45.45" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M59.8903 13.0599C58.4003 12.4499 56.6503 12.72 54.6403 13.88C52.3903 15.18 50.4702 17.21 48.8702 19.96C48.3902 20.79 47.9802 21.5999 47.6602 22.4099C46.8602 24.3099 46.4702 26.16 46.4702 27.97C46.4702 30.54 47.2702 32.29 48.8702 33.2L35.7703 26.6499L29.3802 23.45L28.8702 23.2C27.2702 22.29 26.4702 20.54 26.4702 17.97C26.4702 15.4 27.2702 12.72 28.8702 9.95997C30.4702 7.20997 32.3903 5.18002 34.6403 3.88002C36.8803 2.59002 38.8003 2.39995 40.4003 3.30995L59.8903 13.0599Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M29.3801 29.8999L29.3501 29.89" stroke="#0B0B0F" stroke-linejoin="round"/></svg>"""
moneysvg = """<svg width="48" height="48" viewBox="0 0 69 116" fill="#FF4E4C" xmlns="http://www.w3.org/2000/svg" stroke-width="1px" stroke-linecap="round" stroke-linejoin="round"><path d="M40.3301 112.91L20.3301 102.91C19.4101 102.38 18.9502 101.34 18.9502 99.77V99.02L24.6902 101.89L27.3101 103.19L28.2002 103.64C28.6002 103.82 29.0202 103.97 29.4502 104.08C32.1802 104.81 35.3402 104.59 38.9502 103.43V109.77C38.9502 111.34 39.4101 112.38 40.3301 112.91Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M59.6096 53.9801C56.9496 52.8501 53.5096 52.8001 49.2996 53.8401C48.1496 54.1301 47.0696 54.3801 46.0496 54.6001C41.8096 55.5201 38.7296 55.8301 36.7896 55.5401C34.3796 55.1801 33.1797 53.4801 33.1797 50.4501C33.1797 48.0801 33.8996 45.6401 35.3496 43.1201C37.0496 43.1701 38.5496 43.4901 39.8496 44.0901L40.4097 44.3701L59.6096 53.9801Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M46.9102 12.6101C46.0402 12.2501 44.99 12.4301 43.76 13.1401C43.53 13.2801 43.3001 13.4201 43.0801 13.5901C42.8201 13.7701 42.5701 13.9801 42.3201 14.2001C41.5701 14.8801 40.9101 15.7201 40.3301 16.7101C39.4101 18.3001 38.9502 19.8801 38.9502 21.4401V27.5101L29.54 22.8101L18.9502 17.5101V11.4401C18.9502 9.88012 19.4101 8.3001 20.3301 6.7101C21.2601 5.1201 22.4 3.93011 23.76 3.14011C25.13 2.35011 26.2702 2.22011 27.1902 2.75011L46.9102 12.6101Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M58.8704 21.4801C58.1404 21.1501 57.3503 20.9101 56.5103 20.7601C54.2703 20.3501 51.6203 20.7501 48.5703 21.9601V16.3301L58.8704 21.4801Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M38.9507 27.51C35.4207 30.01 31.9806 33.89 28.6106 39.14C27.4606 40.94 26.5105 42.78 25.7505 44.66C24.2905 48.28 23.5605 52.06 23.5605 56C23.5605 56.25 23.5606 56.5 23.5706 56.74C23.6906 61.32 24.9706 64.54 27.4006 66.41C27.5806 66.55 27.7607 66.67 27.9607 66.78L8.63062 57.14L8.47046 57.06C8.08046 56.88 7.72063 56.66 7.40063 56.41C4.84063 54.44 3.56055 50.97 3.56055 46C3.56055 40.02 5.2406 34.4 8.6106 29.14C11.9806 23.89 15.4207 20.01 18.9507 17.51L29.5405 22.81L38.9507 27.51Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M28.9497 67.28L28.8496 67.23" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M56.5095 72.5802C56.5095 76.1702 55.3696 79.4802 53.0796 82.5002C50.7996 85.5202 48.0095 87.9802 44.7295 89.8802C41.6795 91.6402 39.1095 92.4102 37.0295 92.1802C34.9395 91.9602 33.2196 90.8602 31.8596 88.8902C31.6396 88.5402 31.3896 88.2602 31.0996 88.0502C30.9796 87.9602 30.8495 87.8802 30.7195 87.8102L19.5696 82.2302L19.2695 82.0802C20.8795 81.8002 22.6795 81.0602 24.7295 79.8802C28.0095 77.9802 30.7996 75.5202 33.0796 72.5002C34.1696 71.0802 34.9796 69.5902 35.5496 68.0302C37.3396 67.9102 39.3596 67.6002 41.5996 67.1202C42.7196 66.8902 43.7595 66.7002 44.7395 66.5302C49.3595 65.7602 52.4096 65.7302 53.8696 66.4502C55.6296 67.3202 56.5095 69.3602 56.5095 72.5802Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M66.1402 66.7501C66.1402 73.2801 64.4501 79.2301 61.0801 84.5701C57.7201 89.9201 53.5501 94.4501 48.5701 98.1501V104.22C48.5701 105.78 48.1102 107.36 47.1902 108.95C46.2702 110.54 45.13 111.73 43.76 112.52C42.4 113.3 41.2601 113.43 40.3301 112.91C39.4101 112.38 38.9502 111.34 38.9502 109.77V103.43C35.3402 104.59 32.1802 104.81 29.4502 104.08C29.0202 103.97 28.6002 103.82 28.2002 103.64L27.3101 103.19C26.5401 102.75 25.8202 102.19 25.1502 101.5C24.2902 100.61 23.5101 99.5301 22.8301 98.2401C22.2701 97.2701 22.2501 95.9301 22.7701 94.2001C23.3001 92.4701 24.2401 90.9001 25.6001 89.4601C26.7201 88.2601 27.8901 87.6201 29.0901 87.5201C29.2001 87.5101 29.2902 87.5101 29.3902 87.5101H29.4002C29.7202 87.5101 30.0201 87.5501 30.3001 87.6501H30.3101C30.4501 87.6901 30.59 87.7401 30.72 87.8101C30.85 87.8801 30.9801 87.96 31.1001 88.05C31.3901 88.26 31.6401 88.54 31.8601 88.89C33.2201 90.86 34.9401 91.9601 37.0301 92.1801C39.1101 92.4101 41.68 91.6401 44.73 89.8801C48.01 87.9801 50.8001 85.5201 53.0801 82.5001C55.3701 79.4801 56.51 76.1701 56.51 72.5801C56.51 69.3601 55.6302 67.3201 53.8702 66.4501C52.4102 65.7301 49.36 65.7601 44.74 66.5301C43.76 66.7001 42.7201 66.8901 41.6001 67.1201C39.3601 67.6001 37.3401 67.9101 35.5501 68.0301C32.7601 68.2201 30.5201 67.9501 28.8501 67.2301L27.9602 66.7801C27.7602 66.6701 27.5802 66.5501 27.4002 66.4101C24.9702 64.5401 23.6901 61.3201 23.5701 56.7401C23.5601 56.5001 23.5601 56.2501 23.5601 56.0001C23.5601 52.0601 24.29 48.2801 25.75 44.6601C26.51 42.7801 27.4601 40.9401 28.6101 39.1401C31.9801 33.8901 35.4202 30.0101 38.9502 27.5101V21.4401C38.9502 19.8801 39.4101 18.3001 40.3301 16.7101C40.9101 15.7201 41.5701 14.8801 42.3201 14.2001C42.5701 13.9801 42.8201 13.7701 43.0801 13.5901C43.3001 13.4201 43.53 13.2801 43.76 13.1401C44.99 12.4301 46.0402 12.2501 46.9102 12.6101L47.1902 12.7501C48.1102 13.2801 48.5701 14.3201 48.5701 15.8801V21.9601C51.6201 20.7501 54.27 20.3501 56.51 20.7601C57.35 20.9101 58.1402 21.1501 58.8702 21.4801L59.4002 21.74C60.4002 22.26 61.2801 22.9601 62.0501 23.8401C62.7701 24.6201 62.91 25.87 62.47 27.6C62.03 29.33 61.12 30.9101 59.76 32.3401C58.64 33.5401 57.4801 34.2301 56.2701 34.4201C55.0701 34.6101 53.9502 34.3601 52.9002 33.6701C51.8602 32.9901 50.64 32.7001 49.24 32.8201C47.83 32.9401 46.09 33.6101 44 34.8101C40.48 36.8501 37.7902 39.3001 35.9402 42.1501C35.7302 42.4701 35.5401 42.8001 35.3501 43.1201C33.9001 45.6401 33.1802 48.0801 33.1802 50.4501C33.1802 53.4801 34.3801 55.1801 36.7901 55.5401C38.7301 55.8301 41.8101 55.5201 46.0501 54.6001C47.0701 54.3801 48.1501 54.1301 49.3001 53.8401C53.5101 52.8001 56.9501 52.8501 59.6101 53.9801L60.4602 54.4001C60.9602 54.6701 61.4302 54.9901 61.8702 55.3501C64.7102 57.7001 66.1402 61.5101 66.1402 66.7501Z" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M60.6399 54.4901L60.46 54.4001" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M10.5696 77.7502L10.5195 77.7202" stroke="#0B0B0F" stroke-linejoin="round"/><path d="M30.72 87.8101C30.59 87.7401 30.4501 87.6901 30.3101 87.6501H30.3001C30.0201 87.5501 29.7202 87.5101 29.4002 87.5101H29.3902C29.2902 87.5101 29.2001 87.5101 29.0901 87.5201C27.8901 87.6201 26.7201 88.2601 25.6001 89.4601C24.2401 90.9001 23.3001 92.4701 22.7701 94.2001C22.2501 95.9301 22.2701 97.2701 22.8301 98.2401C23.5101 99.5301 24.2902 100.61 25.1502 101.5C25.8202 102.19 26.5401 102.75 27.3101 103.19L24.6902 101.89L18.9502 99.0201L7.98002 93.5401L7.55009 93.3301C5.68009 92.3301 4.11012 90.6401 2.83012 88.2401C2.27012 87.2701 2.25006 85.9301 2.77006 84.2001C3.30006 82.4701 4.24014 80.9001 5.60014 79.4601C6.72014 78.2601 7.89013 77.6201 9.09013 77.5201C9.64013 77.4701 10.1401 77.5501 10.5701 77.7501L19.26 82.0801H19.2701L19.5701 82.2301L30.72 87.8101Z" stroke="#0B0B0F" stroke-linejoin="round"/></svg>"""

# ==========================================
# 1. KONFIGURASI HALAMAN & CSS (STYLING)
# ==========================================
st.set_page_config(
    page_title="Dashboard Ketenagakerjaan Indonesia",
    page_icon=chartsvg,
    layout="wide",
    initial_sidebar_state="collapsed"
)

# CSS Custom untuk Tampilan "Card" yang Elegan
st.markdown("""
    <style>
        .stApp { background-color: #F0F2F6; }
        
        /* Container Styling */
        div[data-testid="stVerticalBlockBorderWrapper"] {
            background-color: #FFFFFF;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #E0E0E0;
            margin-bottom: 20px;
        }

        /* Styling Headers */
        h3 {
            margin-top: 0 !important;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            font-weight: 600;
            color: #333;
        }
        
        /* Metric Value */
        div[data-testid="stMetricValue"] {
            font-size: 24px;
            color: #007BFF;
        }
    </style>
""", unsafe_allow_html=True)

st.title("Dashboard Ketenagakerjaan Indonesia")
st.markdown("Sumber Data: https://www.bps.go.id/id/statistics-table?subject=520")

# ==========================================
# 2. LOAD DATA
# ==========================================
@st.cache_data
def load_data():
    # Load Data Makro
    try:
        df_makro = pd.read_csv("clean_persentaseBekerjaPengangguran.csv")
        df_makro = df_makro.rename(columns={'Status': 'Tahun', 'Tahun': 'Bulan', 'Periode': 'Persentase', 'Jumlah_Orang': 'Jumlah'})
        df_makro['Persentase'] = pd.to_numeric(df_makro['Persentase'], errors='coerce')
        df_makro['Status'] = df_makro['Persentase'].apply(lambda x: 'Bekerja' if x > 50 else 'Pengangguran')
        df_makro = df_makro[df_makro['Bulan'] != 'Tahunan']
    except: df_makro = pd.DataFrame()

    # Load Data Umur
    try:
        df_umur = pd.read_csv("clean_kelompokUmurPengangguran.csv")
        df_umur['TPT'] = pd.to_numeric(df_umur['TPT'], errors='coerce') 
        unique_vals = df_umur['Tahun'].unique()
        mapping_tahun = {val: 2018 + i for i, val in enumerate(unique_vals)} 
        df_umur['Tahun_Real'] = df_umur['Tahun'].map(mapping_tahun)
    except: df_umur = pd.DataFrame()

    # Load Data Lapangan Usaha
    try:
        df_lapangan = pd.read_csv("clean_RataRataLapangan.csv")
        df_lapangan.columns = ['Provinsi', 'Pertanian', 'Industri', 'Jasa', 'Total', 'Tahun']
        for col in ['Pertanian', 'Industri', 'Jasa', 'Total']:
            df_lapangan[col] = pd.to_numeric(df_lapangan[col], errors='coerce')
        df_lapangan = df_lapangan.dropna(subset=['Total', 'Pertanian', 'Industri'])
    except: df_lapangan = pd.DataFrame()

    # Load Data Pendidikan
    try:
        df_pendidikan = pd.read_csv("clean_RataRataPendidikan.csv")
        df_pendidikan.columns = ['Provinsi', 'Tidak_Sekolah', 'SD', 'SMP', 'SMA_Keatas', 'Total', 'Tahun']
        for col in ['Tidak_Sekolah', 'SD', 'SMP', 'SMA_Keatas', 'Total']:
            df_pendidikan[col] = pd.to_numeric(df_pendidikan[col], errors='coerce')
        df_pendidikan = df_pendidikan.dropna(subset=['SD', 'SMA_Keatas'])
    except: df_pendidikan = pd.DataFrame()

    return df_makro, df_umur, df_lapangan, df_pendidikan

df_makro, df_umur, df_lapangan, df_pendidikan = load_data()


# ==========================================
# BARIS 1: TINJAUAN MAKRO EKONOMI (METRIK)
# ==========================================
with st.container(border=True):
    col_h1, col_f1 = st.columns([3, 1])
    with col_h1:
        st.markdown(f"### {statsvg} Tinjauan Makro Ekonomi (KPI)", unsafe_allow_html=True)
    with col_f1:
        filter_tahun_makro = st.slider("Tahun Laporan:", 2019, 2023, 2023, key="slider_makro")

    if not df_makro.empty and not df_lapangan.empty:
        curr_tpt = df_makro[(df_makro['Tahun'] == filter_tahun_makro) & (df_makro['Bulan'] == 'Agustus') & (df_makro['Status'] == 'Pengangguran')]['Persentase'].values
        prev_tpt = df_makro[(df_makro['Tahun'] == filter_tahun_makro-1) & (df_makro['Bulan'] == 'Agustus') & (df_makro['Status'] == 'Pengangguran')]['Persentase'].values
        curr_gaji = df_lapangan[df_lapangan['Tahun'] == filter_tahun_makro]['Total'].mean()
        
        val_tpt = curr_tpt[0] if len(curr_tpt) > 0 else 0
        delta_tpt = val_tpt - prev_tpt[0] if len(prev_tpt) > 0 else 0
        
        m1, m2, m3 = st.columns(3)
        m1.metric("TPT (Agustus)", f"{val_tpt}%", f"{delta_tpt:.2f}%", delta_color="inverse")
        m2.metric("Rata-rata Upah Nasional", f"Rp {curr_gaji/1000000:.2f} Juta", "per bulan")
        m3.metric("Status Data", f"Tahun {filter_tahun_makro}", "Data Tahunan")


# ==========================================
# BARIS 2: INFORMASI PENGANGGURAN (2 KOLOM)
# ==========================================
with st.container(border=True):
    st.markdown(f"### {peoplesvg} Analisis Pengangguran", unsafe_allow_html=True)
    
    col_trend, col_age = st.columns(2)

    # --- KOLOM 1: TREN PENGANGGURAN ---
    with col_trend:
        st.subheader("**Tren Tingkat Pengangguran Terbuka (TPT)**")
        if not df_makro.empty:
            df_trend = df_makro[df_makro['Status'] == 'Pengangguran'].sort_values(['Tahun', 'Bulan'])
            df_trend['Waktu'] = df_trend['Tahun'].astype(str) + " - " + df_trend['Bulan']
            
            peak_covid = df_trend[df_trend['Tahun'] == 2020]['Persentase'].max()
            peak_label = df_trend[df_trend['Persentase'] == peak_covid]['Waktu'].values[0]

            fig_trend = px.line(df_trend, x='Waktu', y='Persentase', markers=True)
            fig_trend.update_traces(line_color='#FF4B4B', line_width=3, marker_size=8)
            
            # Anotasi & Garis Referensi
            fig_trend.add_annotation(
                x=peak_label, y=peak_covid, text="Puncak COVID-19",
                showarrow=True, arrowhead=2, ax=0, ay=-30,
                bgcolor="#ffdede", bordercolor="red"
            )
            fig_trend.add_vline(x=f"{filter_tahun_makro} - Agustus", line_width=1, line_dash="dash", line_color="grey")
            fig_trend.update_layout(height=435, margin=dict(l=20, r=20, t=10, b=10))
            st.plotly_chart(fig_trend, use_container_width=True)

    # --- KOLOM 2: DISTRIBUSI UMUR ---
    with col_age:
        # Filter khusus untuk chart umur diletakkan di dalam kolomnya agar rapi
        st.subheader(f"**Distribusi Umur**")
        opts_tahun = sorted(df_umur['Tahun_Real'].dropna().unique(), reverse=True) if not df_umur.empty else [2023]
        filter_tahun_demo = st.selectbox("Tahun:", opts_tahun, key="sel_demo_age")

        if not df_umur.empty:
            df_age = df_umur[(df_umur['Tahun_Real'] == filter_tahun_demo) & (df_umur['Kelompok Umur'] != 'Rata-Rata')].copy()
            if not df_age.empty:
                max_val = df_age['TPT'].max()
                colors = ['#FF4B4B' if x == max_val else '#FFB3B3' for x in df_age['TPT']]
                
                fig_age = px.bar(df_age, x='Kelompok Umur', y='TPT', 
                                 text_auto='.1f', title=f"TPT per Umur ({filter_tahun_demo})")
                fig_age.update_traces(marker_color=colors, textposition='outside')
                fig_age.update_layout(height=350, margin=dict(l=0,r=0,t=30,b=0), xaxis_title=None)
                st.plotly_chart(fig_age, use_container_width=True)


# ==========================================
# BARIS 3: SISA INFORMASI (PENDIDIKAN & SEKTOR)
# ==========================================
with st.container(border=True):
    st.markdown(f"### {moneysvg} Analisis Upah: Pendidikan dan Sektoral", unsafe_allow_html=True)
    
    col_edu, col_sect = st.columns(2)

    # --- KOLOM 1: GAP PENDIDIKAN ---
    with col_edu:
        st.subheader("**Gap Upah Berdasarkan Pendidikan**")
        
        # Filter Pendidikan
        edu_labels = {'Tidak_Sekolah': 'Tidak Sekolah', 'SD': 'SD', 'SMP': 'SMP', 'SMA_Keatas': 'SMA+'}
        ce1, ce2 = st.columns(2)
        with ce1:
            edu_1 = st.selectbox("Pendidikan 1:", list(edu_labels.keys()), index=1, format_func=lambda x: edu_labels[x], key="e1")
        with ce2:
            edu_2 = st.selectbox("Pendidikan 2:", list(edu_labels.keys()), index=3, format_func=lambda x: edu_labels[x], key="e2")

        if not df_pendidikan.empty:
            # Gunakan tahun dari filter demografi di atas atau default 2023
            df_edu = df_pendidikan[df_pendidikan['Tahun'] == filter_tahun_demo].copy()
            
            # Multiselect Provinsi (dimasukkan dalam expander agar hemat tempat)
            with st.expander("Filter Provinsi", expanded=False):
                all_provs = sorted(df_edu['Provinsi'].unique().tolist())
                sel_provs = st.multiselect("Pilih:", all_provs, default=all_provs[:10], key="ms_prov") # Default top 10 agar grafik tidak penuh
            
            if not df_edu.empty:
                target_provs = sel_provs if sel_provs else all_provs
                df_viz = df_edu[df_edu['Provinsi'].isin(target_provs)].copy()
                df_viz['Gap'] = df_viz[edu_2] - df_viz[edu_1]
                df_viz = df_viz.sort_values('Gap')

                fig_gap = go.Figure()
                # Garis
                for i in range(len(df_viz)):
                    fig_gap.add_shape(type='line',
                                    x0=df_viz.iloc[i][edu_1], y0=df_viz.iloc[i]['Provinsi'],
                                    x1=df_viz.iloc[i][edu_2], y1=df_viz.iloc[i]['Provinsi'],
                                    line=dict(color='lightgrey', width=2))
                # Marker
                fig_gap.add_trace(go.Scatter(x=df_viz[edu_1], y=df_viz['Provinsi'], mode='markers', name=edu_labels[edu_1], marker=dict(color='#FFA500', size=8)))
                fig_gap.add_trace(go.Scatter(x=df_viz[edu_2], y=df_viz['Provinsi'], mode='markers', name=edu_labels[edu_2], marker=dict(color='#000080', size=8)))
                
                # Tinggi dinamis berdasarkan jumlah data
                h_dynamic = max(350, len(df_viz) * 25)
                fig_gap.update_layout(height=h_dynamic, margin=dict(l=0,r=0,t=10,b=0), legend=dict(orientation="h", y=1.1))
                st.plotly_chart(fig_gap, use_container_width=True)

    # --- KOLOM 2: ANALISIS SEKTORAL ---
    with col_sect:
        st.subheader("**Komparasi Upah Sektoral**")
        
        # Penataan Filter di dalam kolom sektoral
        c_sec_f1, c_sec_f2 = st.columns(2)
        with c_sec_f1:
            prov_list = sorted(df_lapangan['Provinsi'].unique()) if not df_lapangan.empty else []
            filter_prov = st.selectbox("Wilayah:", ["Semua Provinsi (Top 10)"] + prov_list, key="sel_prov_sect")
        with c_sec_f2:
            # Pilihan sektor yang tersedia
            sektor_options = ['Pertanian', 'Industri', 'Jasa']
            filter_sektor = st.selectbox("Sektor Utama:", sektor_options, index=1, key="sel_sektor_val")

        if not df_lapangan.empty:
            # Gunakan data tahun terbaru (2023)
            df_sect = df_lapangan[df_lapangan['Tahun'] == 2023].copy()

            if filter_prov == "Semua Provinsi (Top 10)":
                # Menampilkan 10 Provinsi tertinggi berdasarkan sektor yang dipilih
                df_show = df_sect.sort_values(filter_sektor, ascending=False).head(10)
                fig_sect = px.bar(
                    df_show, 
                    x=filter_sektor, 
                    y='Provinsi', 
                    orientation='h', 
                    title=f"Top 10 Provinsi - Upah Sektor {filter_sektor}",
                    color=filter_sektor,
                    color_continuous_scale='Reds',
                    labels={filter_sektor: 'Rata-rata Upah (Rp)'}
                )
                fig_sect.update_layout(yaxis=dict(autorange="reversed"))
            else:
                # Menampilkan perbandingan semua sektor di provinsi tertentu
                df_prov_only = df_sect[df_sect['Provinsi'] == filter_prov]
                df_melt = df_prov_only.melt(
                    id_vars=['Provinsi'], 
                    value_vars=sektor_options, 
                    var_name='Sektor', 
                    value_name='Upah'
                )
                
                # Highlight sektor yang dipilih di filter
                colors = ['#FF4B4B' if s == filter_sektor else '#D3D3D3' for s in df_melt['Sektor']]
                
                fig_sect = px.bar(
                    df_melt, 
                    x='Sektor', 
                    y='Upah',
                    title=f"Perbandingan Upah di {filter_prov}",
                    text_auto='.2s'
                )
                fig_sect.update_traces(marker_color=colors)
            
            fig_sect.update_layout(height=412, margin=dict(l=0, r=0, t=40, b=0))
            st.plotly_chart(fig_sect, use_container_width=True)